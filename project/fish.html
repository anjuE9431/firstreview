{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <h2 class="mb-3">Fish Management</h2>

  {% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, msg in messages %}
      <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
        {{ msg }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  {% endif %}
  {% endwith %}
  <a href="{{ url_for('add_fish') }}" class="btn btn-success mb-3">+ Add New Fish</a>


  <table class="table table-bordered table-hover align-middle">
    <thead class="table-dark">
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Price (â‚¹)</th>
        <th>Stock</th>
        <th>Harbour</th>
        <th>Image</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for f in fish_list %}
      <tr>
        <td>{{ f.id }}</td>
        <td>{{ f.name }}</td>
        <td>{{ "%.2f"|format(f.price) }}</td>
        <td>{{ f.stock }}</td>
        <td>{{ f.harbour_name }}</td>
        <td>
          {% if f.image %}
            <img src="{{ url_for('static', filename='uploads/fish/' ~ f.image) }}" alt="{{ f.name }}" width="70" height="50">
          {% else %}
            <span class="text-muted">No image</span>
          {% endif %}
        </td>
        <td>
           <a href="{{ url_for('admin_edit_fish', fid=f.id) }}" class="btn btn-sm btn-primary">Edit</a>

            <form action="{{ url_for('delete_fish', fid=f.id) }}" method="post" style="display:inline;">
            <button type="submit" class="btn btn-sm btn-danger"
             onclick="return confirm('Are you sure you want to delete {{ f.name }}?');">
              Delete
            </button>
            </form>
        </td>

      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
